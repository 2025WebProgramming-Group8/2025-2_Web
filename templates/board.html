{% extends 'base.html' %} 
{% block title %}ê²Œì‹œíŒ{% endblock %}

{% block header_content %}
    <header class="head">
        <h1 class="title">ê²Œì‹œíŒ</h1>
    </header>
{% endblock %}

{% block content %}
<style>
    :root{ --bg:#0e0f13; --panel:#161821; --ink:#e9eaf3; --muted:#a4a7b8; --line:#232637; --accent:#93b2ff; --card:#1b1e2a; }
    *{ box-sizing:border-box }
    html,body{ height:100% }
    body{ margin:0; background:var(--bg); color:var(--ink); font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR",sans-serif; }
    a{ color:inherit; text-decoration:none }

    /* Page Title */
    .head{ max-width:900px; margin:32px auto 16px; padding:0 20px }
    .title{ font-size:28px; font-weight:900; margin:0 0 10px }

    /* Search */
    .search{ max-width:900px; margin:0 auto 22px; padding:0 20px }
    .search input{ width:100%; background:var(--panel); border:1px solid var(--line); color:var(--ink); border-radius:14px; padding:14px 16px; font-size:15px }
    .search input::placeholder{ color:var(--muted) }

    /* List Layout (Grid ìˆ˜ì •ë¨) */
    .list { 
        max-width:900px; margin:0 auto 40px; padding:0 20px; 
        display:grid; 
        /* ğŸ‘‡ [í•µì‹¬ ë³€ê²½] ì»¬ëŸ¼ì„ 3ê°œë¡œ ë‚˜ëˆ”: [ì™¼ìª½ ë²„íŠ¼] [ë‚´ìš©] [ì˜¤ë¥¸ìª½ ì…ì¥ë²„íŠ¼] */
        grid-template-columns: 80px 1fr 80px; 
        gap:12px 
    }
    
    .cell { background:var(--panel); border:1px solid var(--line); border-radius:12px; min-height:60px; display:flex; align-items:center; justify-content:center; padding:12px; }
    
    /* 1. ì™¼ìª½ ê´€ë¦¬ ë²„íŠ¼ ì˜ì—­ */
    .cell.admin {
        flex-direction: column; /* ë²„íŠ¼ ìœ„ì•„ë˜ ë°°ì¹˜ */
        gap: 6px;
        background: #161821;
    }

    /* 2. ê°€ìš´ë° ì´ë¦„/ì„¤ëª… ì˜ì—­ */
    .cell.name { 
        justify-content: center; 
        align-items: flex-start; 
        flex-direction: column;  
        gap: 4px;    
        padding-left: 16px;
    }
    
    .group-title { font-weight: 700; font-size: 16px; }
    .group-desc {
        font-size: 13px; color: var(--muted); font-weight: 400;
        white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 100%;
    }

    /* 3. ì˜¤ë¥¸ìª½ ì…ì¥ ë²„íŠ¼ ì˜ì—­ */
    .cell.cta { background:#1b1e29; cursor:pointer; font-weight: bold; font-size: 14px; }
    .cell.cta:hover { outline:2px solid #2a2f47; }

    /* Create button */
    .create-wrap{ max-width:900px; margin:10px auto 30px; padding:0 20px; display:flex; justify-content:flex-end }
    .create{ background:var(--accent); color:#0b0c12; font-weight:800; border:none; border-radius:14px; padding:12px 16px; cursor:pointer }

    /* Responsive */
    @media (max-width:700px){
      .list{ grid-template-columns: 60px 1fr 60px; }
    }
</style>

    <div class="search">
        <form method="get" action="{% url 'board' %}">
            <input type="text" name="q" placeholder="ê³¼ëª©ëª…, ê·¸ë£¹ëª…, ëª©í‘œë¡œ ê²€ìƒ‰" aria-label="ìŠ¤í„°ë”” ê²€ìƒ‰" value="{{ request.GET.q|default:'' }}" />
        </form>
    </div>

    <section class="list" aria-label="ìŠ¤í„°ë”” ê·¸ë£¹ ëª©ë¡">
        
        {% if groups %}
            {% for group in groups %}
            
            <div class="cell admin">
                <form action="{% url 'report_study' group.group_code %}" method="post" onsubmit="return confirm('ì´ ìŠ¤í„°ë””ë¥¼ ì‹ ê³ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?');" style="width:100%;">
                    {% csrf_token %}
                    <button type="submit" style="width:100%; background:none; border:1px solid #3a1918; color:#ff6b6b; border-radius:6px; padding:4px; cursor:pointer; font-size:12px;" title="ì‹ ê³ ">
                        ğŸš¨
                    </button>
                </form>

                {% if request.user.username == 'lazycat' %}
                    <form action="{% url 'delete_study' group.group_code %}" method="post" onsubmit="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');" style="width:100%;">
                        {% csrf_token %}
                        <button type="submit" style="width:100%; background:#ff6b6b; border:none; color:white; border-radius:6px; padding:4px; cursor:pointer; font-size:12px;">
                            ì‚­ì œ
                        </button>
                    </form>
                {% endif %}
            </div>

            <div class="cell name">
                <div class="group-title">
                    [{{ group.subject }}] {{ group.name }}
                </div>
                
                {% if group.description %}
                    <div class="group-desc">
                        {{ group.description|truncatechars:40 }}
                    </div>
                {% endif %}
                
                {% if request.user.username == 'lazycat' and group.report_count > 0 %}
                    <div style="font-size: 11px; color: #ff6b6b; margin-top: 2px;">
                        (ì‹ ê³ : {{ group.report_count }})
                    </div>
                {% endif %}
            </div>

            <div class="cell cta">
                <a href="{% url 'timer' group_code=group.group_code %}" style="width:100%; height:100%; display:flex; align-items:center; justify-content:center;">
                    ì…ì¥
                </a>
            </div>
            {% endfor %}
            
        {% else %}
            <div class="cell name" style="grid-column: 1 / -1; justify-content: center; color: gray;">
                ì•„ì§ ê°œì„¤ëœ ìŠ¤í„°ë””ê°€ ì—†ìŠµë‹ˆë‹¤.
            </div>
        {% endif %}

    </section>

    <div class="create-wrap">
        <a href="{% url 'create_study' %}" class="create" aria-label="ìŠ¤í„°ë”” ê°œì„¤í•˜ê¸°">ìŠ¤í„°ë”” ê°œì„¤í•˜ê¸°</a>
    </div>
{% endblock %}