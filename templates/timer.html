{% extends 'base.html' %} 
{% block title %}타이머{% endblock %}

{% block top_area %}
    <div class="topbar" style="max-width:1100px;margin:16px auto 0;padding:0 20px">
        <div class="btn" aria-label="뒤로">←</div>
        <div class="room" aria-label="스터디룸 이름">{{ study.name }}</div>
        <div class="btn" aria-label="홈">홈</div>
    </div> 
{% endblock %}

{% block header_content %}
    {% endblock %}

{% block content %}
  <style>
    :root{ --bg:#0e0f13; --panel:#161821; --ink:#e9eaf3; --muted:#a4a7b8; --line:#232637; --accent:#93b2ff; --ok:#79e08f; --warn:#fbc531; --err:#ff6b6b; }
    *{ box-sizing:border-box }
    html,body{ height:100% }
    body{ margin:0; background:var(--bg); color:var(--ink); font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR",sans-serif; }
    a{ color:inherit; text-decoration:none }

    /* Layout */
    .wrap{ max-width:1100px; margin:24px auto; padding:0 20px; display:grid; grid-template-columns: 1fr 320px; gap:16px }
    .panel{ background:#1b1e2a; border:1px solid var(--line); border-radius:14px; padding:14px }

    /* Top bar */
    .topbar{ display:grid; grid-template-columns:80px 1fr 80px; gap:10px; margin-bottom:12px }
    .btn{ background:#1b1e29; border:1px solid var(--line); border-radius:10px; padding:10px 12px; text-align:center; cursor:default }
    .room{ background:#161821; border:1px solid var(--line); border-radius:10px; padding:10px 12px; text-align:center; font-weight:800 }

    /* Left  */
    .left{ display:grid; gap:16px }
    .char{ height:220px; display:grid; place-items:center; color:var(--muted); border-radius:12px; border:1px dashed #2a2f47 }

    .members{ display:grid; gap:10px }
    .row{ display:grid; grid-template-columns: 110px 70px 100px 60px 80px; gap:10px; align-items:center }
    .pill{ background:#23273a; border:1px solid var(--line); border-radius:999px; padding:8px 10px; text-align:center; font-weight:800 }
    .state.on{ background:#14361d; border-color:#1f6f38; color:#b9ffd0 }
    .state.off{ background:#3a1918; border-color:#7a2a26; color:#ffd1cc }
    .state.rest{ background:#3a3314; border-color:#7a6a1f; color:#fff0b3 }
    .timebox, .lvl{ background:#1b1e29; border:1px solid var(--line); border-radius:10px; padding:8px 10px; text-align:center }
    .avatar{ width:34px; height:34px; border-radius:999px; background:#2a2f47; border:1px solid var(--line) }

    /* Right */
    .timer{ display:grid; gap:10px }
    .timer .face{ background:#0f121d; border:1px solid var(--line); border-radius:12px; padding:18px; text-align:center; font-size:40px; font-weight:900; letter-spacing:1px }
    .timer .cta{ background:#1b1e29; border:1px solid var(--line); border-radius:10px; padding:12px; text-align:center; font-weight:800 }

    /* Chat input */
    .chat{ max-width:1100px; margin:0 auto 26px; padding:0 20px }
    .chat input{ width:100%; background:#161821; border:1px solid var(--line); border-radius:12px; padding:14px 16px; color:var(--ink) }

    @media (max-width:950px){ .wrap{ grid-template-columns:1fr } }
  </style>
    <section class="left">
        <div class="panel char">캐릭터 사진과 상태</div>

        <div class="panel members" aria-label="그룹원 현황">
            {% for member in study.members.all %}
        <div class="row">
        <div class="pill">{{ member.profile.nickname|default:member.username }}</div>
        
        <div class="pill state off">OFF</div>
        
        <div class="timebox">
            {{ member.profile.total_study_time|default:"00:00" }}
        </div>
        
        <div class="avatar"></div>
        
        <div class="lvl">Lv. {{ member.profile.level }}</div>
    </div>
    {% endfor %}
</div>
    </section>

    <aside class="panel timer" aria-label="타이머">
    <div class="face">00:00</div>
    
    <div class="cta">
        {% if is_member %}
            <span style="cursor:pointer">공부 시작</span>
        {% else %}
            <form action="{% url 'join_study' study.group_code %}" method="post">
                {% csrf_token %}
                <button type="submit" style="background:none; border:none; color:#93b2ff; font-weight:800; font-size:inherit; cursor:pointer;">
                    스터디 가입하기
                </button>
            </form>
        {% endif %}
    </div>
    </aside>
{% endblock %}

{% block chat_input %}
    <div class="chat">
        <input type="text" placeholder="실시간 채팅 입력" aria-label="채팅 입력" />
    </div>
{% endblock %}